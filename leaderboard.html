<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contributor Points - AnimateItnow</title>
  <meta name="description" content="A comprehensive collection of CSS animation templates and effects for web developers" />
  
  <!-- Apple Touch Icons -->
  <!-- Fallback icon -->
  <link rel="icon" type="image/png" href="images/logo.png" />
  <!--Using your existing styles.css exactly like other pages -->
  <link rel="stylesheet" href="styles.css" />
  <link rel="icon" type="image/png" href="images/logo.png" />
  <!--Added Font Awesome for consistent icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  <style>
    /*NO navbar CSS - only leaderboard content styles with proper dark mode support */
    
    /*Main content container - NO background to let page background show through */
    .leaderboard-container {
      min-height: 100vh;
      padding: 0 20px;
      /*Removed background to let page background show through */
    }

    /*Glass heading with proper dark mode support */
    .glass-heading {
      color: #222;
      text-align: center;
      margin: 120px auto 40px auto;
      max-width: 800px;
      padding: 30px 40px 25px 35px;
      border-radius: 20px;
      background: rgba(255,255,255,0.25);
      box-shadow: 0 8px 32px 0 rgba(31,38,135,0.15);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1.5px solid rgba(255,255,255,0.18);
      font-size: 1.6rem;
      font-weight: 700;
      animation: fadeInUp 1s ease;
      transition: all 0.3s ease;
    }

    /*Dark mode for glass heading */
    .dark .glass-heading {
      color: #ffffff;
      background: rgba(255,255,255,0.1);
      border: 1.5px solid rgba(255,255,255,0.1);
      box-shadow: 0 8px 32px 0 rgba(0,0,0,0.3);
    }

    /*Search container with transparent background */
    .search-container {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 40px auto;
      gap: 0;
      flex-wrap: wrap;
      max-width: 500px;
      /*No background to let page background show through */
    }

    /*Search input with proper dark mode */
    .search-input {
      padding: 15px 20px;
      font-size: 1.1rem;
      border-radius: 12px 0 0 12px;
      border: 2px solid #e0e0e0;
      min-width: 280px;
      max-width: 350px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transition: all 0.3s ease;
      background: #ffffff;
      color: #333;
      outline: none;
    }

    .search-input:focus {
      border-color: #007bff;
      box-shadow: 0 4px 20px rgba(0,123,255,0.2);
    }

    /*Dark mode for search input */
    .dark .search-input {
      background: #2d2d2d;
      color: #ffffff;
      border-color: #404040;
    }

    .dark .search-input:focus {
      border-color: #4dabf7;
      box-shadow: 0 4px 20px rgba(77,171,247,0.3);
    }

    /*Search button styling */
    .search-btn {
      padding: 15px 25px;
      font-size: 1.1rem;
      border-radius: 0 12px 12px 0;
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
      color: #fff;
      border: none;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,123,255,0.2);
      transition: all 0.3s ease;
      border: 2px solid #007bff;
    }

    .search-btn:hover {
      background: linear-gradient(135deg, #0056b3 0%, #004085 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,123,255,0.3);
    }

    /*Table container - only white background for table area */
    .table-container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto 40px auto;
      overflow-x: auto;
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      background: #ffffff; /*White background only for table */
      animation: slideUp 1s ease;
      transition: all 0.3s ease;
    }

    /*Dark mode for table container */
    .dark .table-container {
      background: #2d2d2d;
      box-shadow: 0 10px 30px rgba(0,0,0,0.4);
    }

    /*Table styling */
    .leaderboard-table {
      border-collapse: collapse;
      width: 100%;
      background: transparent;
      border-radius: 16px;
      min-width: 600px;
      overflow: hidden;
    }

    .leaderboard-table th,
    .leaderboard-table td {
      padding: 16px 12px;
      text-align: left;
      vertical-align: middle;
      transition: all 0.3s ease;
      border-bottom: 1px solid #f0f0f0;
    }

    /*Dark mode for table cells */
    .dark .leaderboard-table th,
    .dark .leaderboard-table td {
      border-bottom: 1px solid #404040;
    }

    .leaderboard-table th {
      background: linear-gradient(135deg, #1e1e2f 0%, #2d2d4a 100%);
      color: #ffffff;
      font-weight: 700;
      font-size: 1.1rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .leaderboard-table tbody tr {
      transition: all 0.3s ease;
    }

    .leaderboard-table tbody tr:hover {
      background: rgba(0,123,255,0.05);
      transform: translateY(-1px);
    }

    /*Dark mode for table rows */
    .dark .leaderboard-table tbody tr:hover {
      background: rgba(77,171,247,0.1);
    }

    /*Column widths */
    .leaderboard-table th:first-child,
    .leaderboard-table td:first-child {
      width: 80px;
      text-align: center;
      font-weight: 600;
    }

    .leaderboard-table th:nth-child(2),
    .leaderboard-table td:nth-child(2) {
      width: 200px;
    }

    .leaderboard-table th:nth-child(3),
    .leaderboard-table td:nth-child(3) {
      width: auto;
      min-width: 250px;
    }

    .leaderboard-table th:last-child,
    .leaderboard-table td:last-child {
      width: 120px;
      text-align: center;
      font-weight: 600;
      color: #28a745;
    }

    /*Dark mode for points column */
    .dark .leaderboard-table td:last-child {
      color: #51cf66;
    }

    /*Avatar styling */
    .contributor-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 12px;
      vertical-align: middle;
      border: 3px solid #e0e0e0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }

    .contributor-avatar:hover {
      transform: scale(1.1);
      border-color: #007bff;
    }

    /*Dark mode for avatar */
    .dark .contributor-avatar {
      border-color: #404040;
    }

    .dark .contributor-avatar:hover {
      border-color: #4dabf7;
    }

    /*Contributor link styling */
    .contributor-link {
      color: #007bff;
      text-decoration: none;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
    }

    .contributor-link:hover {
      color: #0056b3;
      text-decoration: none;
    }

    /*Dark mode for contributor links */
    .dark .contributor-link {
      color: #4dabf7;
    }

    .dark .contributor-link:hover {
      color: #74c0fc;
    }

    /*PR Details styling */
    .pr-details {
      margin-top: 8px;
      width: 100%;
    }

    .pr-summary {
      cursor: pointer;
      font-weight: 600;
      color: #495057;
      outline: none;
      transition: all 0.3s ease;
      padding: 8px 0;
    }

    .pr-summary:hover {
      color: #007bff;
    }

    /*Dark mode for PR details */
    .dark .pr-summary {
      color: #adb5bd;
    }

    .dark .pr-summary:hover {
      color: #4dabf7;
    }

    .pr-details[open] .pr-summary {
      color: #007bff;
      margin-bottom: 10px;
    }

    .dark .pr-details[open] .pr-summary {
      color: #4dabf7;
    }

    .pr-list {
      margin: 0;
      padding-left: 20px;
      animation: fadeIn 0.4s ease;
    }

    .pr-list li {
      margin-bottom: 6px;
      font-size: 0.95rem;
      line-height: 1.4;
    }

    .pr-list a {
      color: #007bff;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    .pr-list a:hover {
      color: #0056b3;
      text-decoration: underline;
    }

    /*Dark mode for PR list */
    .dark .pr-list a {
      color: #4dabf7;
    }

    .dark .pr-list a:hover {
      color: #74c0fc;
    }

    /*Pagination styling */
    .pagination-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin: 40px 0;
      flex-wrap: wrap;
      /*No background to let page background show through */
    }

    .pagination-btn {
      padding: 12px 20px;
      background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0,123,255,0.2);
    }

    .pagination-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #0056b3 0%, #004085 100%);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,123,255,0.3);
    }

    .pagination-btn:disabled {
      background: #6c757d;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .pagination-info {
      font-weight: 600;
      color: #495057;
      font-size: 1.1rem;
    }

    /*Dark mode for pagination */
    .dark .pagination-info {
      color: #adb5bd;
    }

    /*Download button with transparent background area */
    .download-button {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
      padding: 16px 32px;
      border: none;
      margin: 40px auto 60px auto;
      cursor: pointer;
      font-weight: 700;
      border-radius: 12px;
      font-size: 1.2rem;
      box-shadow: 0 6px 20px rgba(40,167,69,0.2);
      transition: all 0.3s ease;
      display: block;
      animation: fadeIn 1.2s 0.2s backwards;
    }

    .download-button:hover {
      background: linear-gradient(135deg, #20c997 0%, #17a2b8 100%);
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(40,167,69,0.3);
    }

    /*Animation keyframes */
    @keyframes fadeInUp {
      from { 
        opacity: 0;
        transform: translateY(30px);
      }
      to { 
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes slideUp {
      from { 
        transform: translateY(40px); 
        opacity: 0;
      }
      to { 
        transform: translateY(0); 
        opacity: 1;
      }
    }

    @keyframes fadeIn {
      from { opacity: 0 }
      to { opacity: 1 }
    }

    /*Mobile responsive design - NO background overrides */
    @media (max-width: 768px) {
      .leaderboard-container {
        padding: 0 15px;
      }

      .glass-heading {
        font-size: 1.3rem;
        margin: 100px auto 30px auto;
        padding: 20px 25px;
        max-width: 95%;
      }

      .search-container {
        margin: 30px auto;
        flex-direction: column;
        gap: 0;
      }

      .search-input {
        min-width: 100%;
        max-width: 100%;
        border-radius: 12px 12px 0 0;
        margin-bottom: -2px;
      }

      .search-btn {
        width: 100%;
        border-radius: 0 0 12px 12px;
        border-top: none;
      }

      .table-container {
        margin: 0 -15px 30px -15px;
        border-radius: 0;
      }

      .leaderboard-table {
        min-width: 500px;
        font-size: 0.9rem;
      }

      .leaderboard-table th,
      .leaderboard-table td {
        padding: 12px 8px;
      }

      .contributor-avatar {
        width: 32px;
        height: 32px;
        margin-right: 8px;
      }

      .pagination-container {
        gap: 15px;
        margin: 30px 0;
      }

      .pagination-btn {
        padding: 10px 16px;
        font-size: 0.9rem;
      }

      .download-button {
        padding: 14px 28px;
        font-size: 1.1rem;
        margin: 30px auto 40px auto;
      }
    }

    @media (max-width: 480px) {
      .glass-heading {
        font-size: 1.1rem;
        margin: 90px auto 25px auto;
        padding: 16px 20px;
      }

      .leaderboard-table {
        min-width: 400px;
        font-size: 0.8rem;
      }

      .leaderboard-table th,
      .leaderboard-table td {
        padding: 10px 6px;
      }

      .contributor-avatar {
        width: 28px;
        height: 28px;
        margin-right: 6px;
      }

      .pagination-btn {
        padding: 8px 12px;
        font-size: 0.85rem;
      }

      .download-button {
        padding: 12px 24px;
        font-size: 1rem;
      }
    }
  </style>
</head>

<body>
  <!--Using EXACT navbar structure - NO custom navbar CSS -->
  <nav class="navbar scroll-fade">
    <div class="nav-left">
      <img src="images/logo.png" alt="AnimateItNow Logo" class="logo" />
      <span class="site-name">Animate It Now</span>
    </div>
    <div class="nav-right">
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="templates.html">Templates</a></li>
        <li><a href="contributors.html">Contributors</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li><a href="leaderboard.html" class="active">Leaderboard</a></li>
        <!--cursor toggle exactly like other pages -->
        <li class="snakeList">
          <label class="switch" title="Toggle Snake Cursor">
            <input type="checkbox" id="cursorToggle">
            <span class="slider round"></span>
          </label>
          <span class="snakeLabel">Snake Cursor</span>
        </li>
        <!--github icon exactly like other pages -->
        <li>
          <a href="https://github.com/itsAnimation/AnimateItNow"
             target="_blank"
             rel="noopener noreferrer"
             aria-label="GitHub Repo"
             class="github-icon">
            <svg viewBox="0 0 16 16" width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
              <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47
                 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49
                -2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13
                -.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82
               .72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07
              -1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15
              -.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82
              .64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27
              1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12
              .51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95
              .29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2
              0 .21.15.46.55.38A8.01 8.01 0 0016 8c0-4.42-3.58-8-8-8z"/>
            </svg>
          </a>
        </li>
        <li>
          <button id="theme-toggle" aria-label="Toggle Theme">
            <i data-lucide="moon"></i>
          </button>
        </li>
      </ul>
    </div>
  </nav>

  <!--Main leaderboard container with NO background to let page background show -->
  <div class="leaderboard-container">
    <div class="glass-heading">
      üöÄ Contributor Points Dashboard ‚Äì <i>AnimateItnow</i>
    </div>
      
    <div class="search-container">
      <input 
        type="text" 
        id="searchUser" 
        class="search-input"
        placeholder="Search by username..." 
      />
      <button id="searchBtn" class="search-btn">
        üîç Search
      </button>
    </div>

    <!--Table container - always visible, no loading effect -->
    <div class="table-container">
      <table id="pointsTable" class="leaderboard-table">
        <thead>
          <tr>
              <th>Rank</th>
              <th>Contributor</th>
              <th>Merged PRs</th>
              <th>Points</th>
          </tr>
        </thead>
        <tbody>
          <!--Initial message for immediate feedback -->
          <tr><td colspan="4" style="text-align: center; padding: 40px;">Loading data... Please wait.</td></tr>
        </tbody>
      </table>
    </div>

    <div id="pagination" class="pagination-container"></div>

    <button class="download-button" onclick="downloadExcel()">
      üì• Download as Excel
    </button>
  </div>

  <!--Footer exactly like other pages -->
  <footer class="footer scroll-fade">
    <div class="footer-content">
      <div class="footer-left">
        <h2>AnimateItNow</h2>
        <p>Creating impactful web animations and templates for everyone.</p>
      </div>
      <div class="footer-right">
        <h4>Connect With Us</h4>
        <ul>
          <li><a href="https://github.com/itsAnimation/AnimateItNow" target="_blank" rel="noopener noreferrer"><i class="fab fa-github fa-beat"></i> GitHub</a></li>
          <li><a href="https://www.linkedin.com/in/anujshrivastava1/" target="_blank" rel="noopener noreferrer"><i class="fab fa-linkedin fa-beat"></i> LinkedIn</a></li>
          <li><a href="mailto:contact@animateitnow.com" rel="noopener noreferrer"><i class="fas fa-envelope"></i> Email Us</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">
      <p>¬© 2025 AnimateItNow. Made with ‚ù§Ô∏è by <span class="highlight">Anuj</span> and Contributors.</p>
    </div>
  </footer>

  <!--Cursor snake div for consistency -->
  <div id="cursor-snake"></div>

  <script>
 

    //Enhanced leaderboard JavaScript
    const owner = "itsAnimation";
    const repo = "AnimateItnow";
    const token = ""; 
    const pointsPerLevel = {
      "level1": 3,
      "level2": 7,
      "level3": 10
    };

    let contributorsData = [];
    let currentPage = 1;
    const perPage = 20;

    //Fetch merged PRs with error handling
    async function fetchMergedPRs(page = 1, allPRs = []) {
      try {
        const url = `https://api.github.com/repos/${owner}/${repo}/pulls?state=closed&per_page=100&page=${page}`;
        const headers = token ? { Authorization: `token ${token}` } : {};
        const res = await fetch(url, { headers });
        
        if (!res.ok) {
          //Provide more specific error for API issues
          const errorText = await res.text();
          throw new Error(`GitHub API error! Status: ${res.status}. Message: ${errorText}`);
        }
        
        const prs = await res.json();
        if (!Array.isArray(prs)) return allPRs;
        
        const merged = prs.filter(pr => pr.merged_at);
        allPRs = allPRs.concat(merged);
        
        if (prs.length === 100) {
          return fetchMergedPRs(page + 1, allPRs);
        } else {
          return allPRs;
        }
      } catch (error) {
        console.error('Error fetching PRs:', error);
        throw error; // Re-throw to be caught by init()
      }
    }

    //Calculate contributor data from PRs
    function calculateContributorData(prs) {
      const data = {};
      prs.forEach(pr => {
        const user = pr.user.login;
        const avatar = pr.user.avatar_url;
        const prUrl = pr.html_url;
        const title = pr.title;
        const labels = pr.labels.map(label => label.name.toLowerCase());
        const level = labels.find(l => l.startsWith("level")) || "none";
        const points = pointsPerLevel[level] || 0;
        
        if (!data[user]) {
          data[user] = { prs: [], total: 0, avatar };
        }
        data[user].prs.push({ title, url: prUrl, level });
        data[user].total += points;
      });
      return data;
    }

    let filteredData = null;

    //Render table page with proper styling
    function renderTablePage(page) {
      const tbody = document.querySelector("#pointsTable tbody");
      tbody.innerHTML = ""; //Clear any previous messages/loading
      const dataToShow = filteredData || contributorsData;
      const startIdx = (page - 1) * perPage;
      const endIdx = startIdx + perPage;
      let pageData = dataToShow.slice(startIdx, endIdx);

      if (filteredData) {
        //Handle filtered data with original rankings
        pageData = pageData.map(([user, userData]) => {
          const originalIdx = contributorsData.findIndex(([u]) => u === user);
          return { user, userData, originalIdx };
        });
        
        pageData.forEach(({ user, userData, originalIdx }) => {
          const row = document.createElement("tr");
          const prList = userData.prs.map(pr => {
            return `<li>
              <a href="${pr.url}" target="_blank">${pr.title}</a> - <strong>${pr.level}</strong>
            </li>`;
          }).join("");
          
          const collapsible = `<details class="pr-details">
              <summary class="pr-summary">Show PRs (${userData.prs.length})</summary>
              <ul class="pr-list">${prList}</ul>
            </details>`;
            
          row.innerHTML = `
            <td>${originalIdx + 1}</td>
            <td>
              <a href="https://github.com/${user}" target="_blank" class="contributor-link">
                <img class="contributor-avatar" src="${userData.avatar}" alt="${user}'s avatar">
                ${user}
              </a>
            </td>
            <td>${collapsible}</td>
            <td>${userData.total}</td>
          `;
          tbody.appendChild(row);
        });
      } else {
        //Handle normal data display
        pageData.forEach(([user, userData], idx) => {
          const row = document.createElement("tr");
          const prList = userData.prs.map(pr => {
            return `<li>
              <a href="${pr.url}" target="_blank">${pr.title}</a> - <strong>${pr.level}</strong>
            </li>`;
          }).join("");
          
          const collapsible = `<details class="pr-details">
              <summary class="pr-summary">Show PRs (${userData.prs.length})</summary>
              <ul class="pr-list">${prList}</ul>
            </details>`;
            
          row.innerHTML = `
            <td>${startIdx + idx + 1}</td>
            <td>
              <a href="https://github.com/${user}" target="_blank" class="contributor-link">
                <img class="contributor-avatar" src="${userData.avatar}" alt="${user}'s avatar">
                ${user}
              </a>
            </td>
            <td>${collapsible}</td>
            <td>${userData.total}</td>
          `;
          tbody.appendChild(row);
        });
      }
      renderPagination();
    }

    //Render pagination controls
    function renderPagination() {
      const dataToShow = filteredData || contributorsData;
      const totalPages = Math.ceil(dataToShow.length / perPage);
      const pagination = document.getElementById("pagination");
      pagination.innerHTML = "";
      
      if (totalPages <= 1) return;

      const prevBtn = document.createElement("button");
      prevBtn.textContent = "‚Üê Previous";
      prevBtn.className = "pagination-btn";
      prevBtn.disabled = currentPage === 1;
      prevBtn.onclick = () => {
        if (currentPage > 1) {
          currentPage--;
          renderTablePage(currentPage);
        }
      };

      const nextBtn = document.createElement("button");
      nextBtn.textContent = "Next ‚Üí";
      nextBtn.className = "pagination-btn";
      nextBtn.disabled = currentPage === totalPages;
      nextBtn.onclick = () => {
        if (currentPage < totalPages) {
          currentPage++;
          renderTablePage(currentPage);
        }
      };

      const pageInfo = document.createElement("span");
      pageInfo.className = "pagination-info";
      pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;

      pagination.appendChild(prevBtn);
      pagination.appendChild(pageInfo);
      pagination.appendChild(nextBtn);
    }

    //Enhanced search functionality with better UX
    document.addEventListener('DOMContentLoaded', function() {
      const searchBtn = document.getElementById('searchBtn');
      const searchInput = document.getElementById('searchUser');
      
      function performSearch() {
        const val = searchInput.value.trim().toLowerCase();
        if (!val) {
          filteredData = null;
        } else {
          filteredData = contributorsData.filter(([user]) => user.toLowerCase().includes(val));
        }
        currentPage = 1;
        renderTablePage(currentPage);
      }
      
      if (searchBtn && searchInput) {
        searchBtn.addEventListener('click', performSearch);
        
        searchInput.addEventListener('keydown', function(e) {
          if (e.key === 'Enter') {
            performSearch();
          }
        });

        //Clear search on escape key
        searchInput.addEventListener('keydown', function(e) {
          if (e.key === 'Escape') {
            searchInput.value = '';
            performSearch();
          }
        });
      }
    });

    //Download Excel functionality
    function downloadExcel() {
      const table = document.createElement("table");
      table.innerHTML = `<thead><tr>
        <th>Rank</th>
        <th>Contributor</th>
        <th>Merged PRs</th>
        <th>Total Points</th>
      </tr></thead><tbody></tbody>`;
      
      const tbody = table.querySelector("tbody");
      contributorsData.forEach(([user, userData], idx) => {
        const prList = userData.prs.map(pr => {
          return `${pr.title} (${pr.level})`;
        }).join('; ');
        
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${idx + 1}</td>
          <td>${user}</td>
          <td>${prList}</td>
          <td>${userData.total}</td>
        `;
        tbody.appendChild(row);
      });

      const wb = XLSX.utils.table_to_book(table, { sheet: "Contributor Points" });
      XLSX.writeFile(wb, "AnimateItnow_Contributors.xlsx");
    }

    //Initialize leaderboard with error handling and dummy data fallback
    async function init() {
      try {
        const prs = await fetchMergedPRs();
        let fetchedContributors = Object.entries(calculateContributorData(prs)).sort((a, b) => b[1].total - a[1].total);

        //If no data fetched (e.g., due to API limits or no token), use dummy data for demonstration
        if (fetchedContributors.length === 0) {
          console.warn("No data fetched from GitHub. Using dummy data for demonstration.");
          fetchedContributors = [
            ['user1', { prs: [{ title: 'Dummy PR 1', url: '/placeholder.svg?height=40&width=40', level: 'level1' }], total: 10, avatar: '/placeholder.svg?height=40&width=40' }],
            ['user2', { prs: [{ title: 'Dummy PR 2', url: '/placeholder.svg?height=40&width=40', level: 'level2' }], total: 20, avatar: '/placeholder.svg?height=40&width=40' }],
            ['user3', { prs: [{ title: 'Dummy PR 3', url: '/placeholder.svg?height=40&width=40', level: 'level3' }], total: 30, avatar: '/placeholder.svg?height=40&width=40' }],
            ['user4', { prs: [{ title: 'Dummy PR 4', url: '/placeholder.svg?height=40&width=40', level: 'level1' }], total: 15, avatar: '/placeholder.svg?height=40&width=40' }],
            ['user5', { prs: [{ title: 'Dummy PR 5', url: '/placeholder.svg?height=40&width=40', level: 'level2' }], total: 25, avatar: '/placeholder.svg?height=40&width=40' }],
          ].sort((a, b) => b[1].total - a[1].total); // Sort dummy data too
        }
        
        contributorsData = fetchedContributors;
        currentPage = 1;
        renderTablePage(currentPage);
        
      } catch (error) {
        console.error('Error loading leaderboard data:', error);
        
        //Display error message in table if fetch fails
        const tbody = document.querySelector("#pointsTable tbody");
        tbody.innerHTML = `
          <tr>
            <td colspan="4" style="text-align: center; padding: 40px;">
              <div style="font-size: 3rem; margin-bottom: 20px;">‚ö†Ô∏è</div>
              <div style="font-size: 1.2rem; font-weight: 600; margin-bottom: 10px; color: #dc3545;">
                Error Loading Data
              </div>
              <div style="font-size: 0.9rem; color: #666; margin-bottom: 20px;">
                Unable to fetch contributor data. This might be due to GitHub API rate limits or missing authentication.
                Please ensure a valid GitHub Personal Access Token is provided in the 'token' variable if you encounter this frequently.
              </div>
              <button onclick="location.reload()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 6px; cursor: pointer;">
                Retry
              </button>
            </td>
          </tr>
        `;
      }
    }

    //Start initialization
    init();
  </script>

  <!--Required scripts for icons and functionality -->
  <script src="https://unpkg.com/lucide@latest"></script>
  <script src="script.js"></script>
  </body>

</html>
